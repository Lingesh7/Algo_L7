2021-01-28 11:06:06,644:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:06:07,578:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "POST /interactive/user/session HTTP/1.1" 200 None
2021-01-28 11:06:07,593:root:Main Login Successful
2021-01-28 11:06:07,593:root:Calculating everything before executing orders..
2021-01-28 11:06:07,593:root:Calculating weekly and monthly expiry dates..
2021-01-28 11:06:07,593:root:weekly expiry is : 28Jan2021, monthly expiry is: 28Jan2021
2021-01-28 11:06:07,747:root:('StrikePrice computed as : ', 13850)
2021-01-28 11:06:07,747:root:Input of get_eID fn : NIFTY, ce,28Jan2021,13850
2021-01-28 11:06:07,747:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:06:08,549:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "GET /marketdata/instruments/instrument/optionsymbol?exchangeSegment=2&series=OPTIDX&symbol=NIFTY&expiryDate=28Jan2021&optionType=CE&strikePrice=13850 HTTP/1.1" 200 None
2021-01-28 11:06:08,549:root:Exchange Instrument ID : 41438, {41438: 'CE'}
2021-01-28 11:06:08,549:root:Input of get_eID fn : NIFTY, pe,28Jan2021,13850
2021-01-28 11:06:08,565:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:06:09,367:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "GET /marketdata/instruments/instrument/optionsymbol?exchangeSegment=2&series=OPTIDX&symbol=NIFTY&expiryDate=28Jan2021&optionType=PE&strikePrice=13850 HTTP/1.1" 200 None
2021-01-28 11:06:09,367:root:Exchange Instrument ID : 41439, {41438: 'CE', 41439: 'PE'}
2021-01-28 11:06:09,367:root:Checking margin from user..
2021-01-28 11:06:09,367:root:Checking balance..
2021-01-28 11:06:09,367:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:06:11,557:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "GET /interactive/user/balance HTTP/1.1" 200 None
2021-01-28 11:06:11,557:root:Balance retreived success, available cash : 1000000000
2021-01-28 11:06:11,557:root: 
              net_cash - 1000000000,
              strikePrice - 13850,
              Nifty LTP - 13850.3,
              BankNiftyLTP - None
              exchangeInstrumentID - [41438, 41439]
              
2021-01-28 11:06:11,557:root:All set from prepareVars func.. Giving a go for orders..
2021-01-28 11:06:11,557:root:required variables set-- ready to trigger orders at desired time
2021-01-28 11:07:00,330:root:Required Margin Available.. Taking positions...
2021-01-28 11:07:01,395:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:07:01,416:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:07:01,416:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:07:01,434:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:07:02,251:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "POST /interactive/user/session HTTP/1.1" 200 None
2021-01-28 11:07:02,251:root:Main Login Successful
2021-01-28 11:07:02,251:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "POST /interactive/user/session HTTP/1.1" 200 None
2021-01-28 11:07:02,251:root:Main Login Successful
2021-01-28 11:07:02,267:root:Placing Orders with StopLoss..
2021-01-28 11:07:02,267:root:placing order for --, 41438
2021-01-28 11:07:02,267:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:07:02,267:root:Placing Orders with StopLoss..
2021-01-28 11:07:02,267:root:placing order for --, 41439
2021-01-28 11:07:02,267:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:07:02,283:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "POST /interactive/user/session HTTP/1.1" 200 None
2021-01-28 11:07:02,283:root:Main Login Successful
2021-01-28 11:07:02,298:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "POST /interactive/user/session HTTP/1.1" 200 None
2021-01-28 11:07:02,298:root:Main Login Successful
2021-01-28 11:07:03,439:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "POST /interactive/orders HTTP/1.1" 200 None
2021-01-28 11:07:03,455:root:Order ID for SELL 41439 is: 10027689
2021-01-28 11:07:03,455:root:Retreiving OrderBook..
2021-01-28 11:07:03,455:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "POST /interactive/orders HTTP/1.1" 200 None
2021-01-28 11:07:03,455:root:Order ID for SELL 41438 is: 10027690
2021-01-28 11:07:03,455:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:07:03,455:root:Retreiving OrderBook..
2021-01-28 11:07:03,455:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:07:04,342:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "GET /interactive/orders HTTP/1.1" 200 None
2021-01-28 11:07:04,342:root:OrderBook result retreived success
2021-01-28 11:07:04,342:root:orderId and Traded price in try block of placeOrderWithSL: 10027690 and 52.65
2021-01-28 11:07:04,342:root:Unable to place order in placeOrderWithSL func...
2021-01-28 11:07:04,342:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "GET /interactive/orders HTTP/1.1" 200 None
2021-01-28 11:07:04,342:root:OrderBook result retreived success
2021-01-28 11:07:04,342:root:orderId and Traded price in try block of placeOrderWithSL: 10027689 and 43.05
2021-01-28 11:07:04,342:root:Unable to place order in placeOrderWithSL func...
2021-01-28 11:07:05,360:root:orderDictionary from placeOrderWithSL {41438: []}
2021-01-28 11:07:05,360:root:new dict values :  {'oo': [], 'tt': [], 'qq': [], 'ss': [], 'sl': []}
2021-01-28 11:07:05,491:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:07:06,309:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "POST /marketdata/instruments/subscription HTTP/1.1" 400 70
2021-01-28 11:07:06,309:root:
Traceback (most recent call last):
  File "C:\Users\mling\anaconda3\lib\site-packages\xts-0.1-py3.8.egg\XTConnect\Connect.py", line 513, in send_subscription
    response = self._post('market.instruments.subscription', json.dumps(params))
  File "C:\Users\mling\anaconda3\lib\site-packages\xts-0.1-py3.8.egg\XTConnect\Connect.py", line 639, in _post
    return self._request(route, "POST", params)
  File "C:\Users\mling\anaconda3\lib\site-packages\xts-0.1-py3.8.egg\XTConnect\Connect.py", line 688, in _request
    raise ex.XTSTokenException(data["description"])
XTConnect.Exception.XTSTokenException: Invalid Token

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "F:\Downloads\Python\First_Choice_Git\xts\strategy\Strategy_1.py", line 221, in printPNL
    subs_resp = xt.send_subscription(Instruments=instruments,xtsMessageCode=1502)
  File "C:\Users\mling\anaconda3\lib\site-packages\xts-0.1-py3.8.egg\XTConnect\Connect.py", line 516, in send_subscription
    return response['description']
UnboundLocalError: local variable 'response' referenced before assignment
2021-01-28 11:26:02,891:urllib3.connectionpool:Starting new HTTPS connection (1): developers.symphonyfintech.in:443
2021-01-28 11:26:03,769:urllib3.connectionpool:https://developers.symphonyfintech.in:443 "POST /interactive/user/session HTTP/1.1" 200 None
